# 一元线性回归

线性回归（linear regression)是一种线性模型，它假设输入变量x和单个输出变量y之间存在线性关系

具体来说，利用线性回归模型，可以从一组输入变量x的线性组合中，计算输出变量y

y = ax + b

f(x) = w1x1 + w2x2 + ... +wdxd + b

![Untitled](%E4%B8%80%E5%85%83%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92%2066fee/Untitled.png)

![Untitled](%E4%B8%80%E5%85%83%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92%2066fee/Untitled%201.png)

![Untitled](%E4%B8%80%E5%85%83%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92%2066fee/Untitled%202.png)

```python
import numpy as np
import matplotlib.pyplot as plt

points = np.genfromtxt('F:\\machine learning\\code\\Algorithmcode_JupyterNotebook\\data.csv', delimiter=',')

x = points[:, 0]
y = points[:, 1]
plt.scatter(x, y)
plt.show()

'''定义损失函数'''
def compute_cost(w, b, points):
    total_cost = 0
    M = len(points)

    # 逐点计算平方损失误差，再求平均数
    for i in range(M):
        x = points[i, 0]
        y = points[i, 1]
        total_cost += (y - (w * x) - b) ** 2

    return total_cost / M

'''定义算法拟合函数'''
# 先定义一个求均值的函数
def average(data):
    sum = 0
    num = len(data)
    for i in range(num):
        sum += data[i]
    return sum / num

# 定义核心拟合函数
def fit(points):
    M = len(points)
    x_bar = average(points[:, 0])

    sum_yx = 0
    sum_x2 = 0
    sum_delta = 0

    for i in range(M):
        x = points[i, 0]
        y = points[i, 1]
        sum_yx += y * (x - x_bar)
        sum_x2 += x ** 2
    # 根据公式计算w
    w = sum_yx / (sum_x2 - M * (x_bar ** 2))

    for i in range(M):
        x = points[i, 0]
        y = points[i, 1]
        sum_delta += (y - w * x)
    b = sum_delta / M

    return w, b

'''测试'''

w, b = fit(points)

print("w is: ", w)
print("b is: ", b)

cost = compute_cost(w, b, points)

print("cost is: ", cost)

'''画出拟合曲线'''
plt.scatter(x, y)

pred_y = w * x + b

plt.plot(x, pred_y, c='r')
plt.show()
```